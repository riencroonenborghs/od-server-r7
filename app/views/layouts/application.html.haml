!!!
%html
  %head
    %title
      OD Server - 
      = yield :title 
    %meta(name="viewport" content="width=device-width, initial-scale=1")
    -# = favicon_link_tag asset_path("favicon.png")
    -# %link(rel="apple-touch-icon" href="#{asset_path("apple-touch.png")}")
    = csrf_meta_tags
    = csp_meta_tag

    = stylesheet_link_tag "application", "data-turbo-track": "reload"
    = javascript_include_tag "application", "data-turbo-track": "reload", defer: true
    %link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css")

  %body(id="#{'user' if user_signed_in?}")
    .d-flex
      %nav.navbar.sticky-top.border-end.navbar-light.bg-light.menu.d-flex.flex-column.justify-content-between(style="height: calc(100vh)")
        - if user_signed_in?
          %div
            = link_to root_path, class: "btn" do
              OD
              - unless Rails.env.production?
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=Rails.env.first(3)
            .ps-3.pe-3 &nbsp;
            .menu--queued(class="#{'current-page' if current_page?(queued_downloads_path) || current_page?(root_path)}")
              = link_to queued_downloads_path, title: "Queued Downloads", class: "btn menu--item" do
                %i.bi.bi-list-ul
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=@queue_sizes["queued"]
            .menu--started(class="#{'current-page' if current_page?(started_downloads_path)}")
              = link_to started_downloads_path, title: "Started Downloads", class: "btn menu--item" do
                %i.bi.bi-cloud-download
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=@queue_sizes["started"]
            .menu--finished(class="#{'current-page' if current_page?(finished_downloads_path)}")
              = link_to finished_downloads_path, title: "Finished Downloads", class: "btn menu--item" do
                %i.bi.bi-check2
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=@queue_sizes["finished"]
            .menu--cancelled(class="#{'current-page' if current_page?(cancelled_downloads_path)}")
              = link_to cancelled_downloads_path, title: "Cancelled Downloads", class: "btn menu--item" do
                %i.bi.bi-x-lg
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=@queue_sizes["cancelled"]
            .menu--failed(class="#{'current-page' if current_page?(failed_downloads_path)}")
              = link_to failed_downloads_path, title: "Failed Downloads", class: "btn menu--item" do
                %i.bi.bi-cone-striped
                %span.fs-11.menu--item--queue.badge.rounded-pill.bg-danger=@queue_sizes["failed"]
          %dvi
            %div(class="#{'current-page' if current_page?(new_download_path)}")
              = link_to new_download_path, title: "New Download", class: "btn" do
                %i.bi.bi-plus-lg
            %div(class="#{'current-page' if current_page?(new_search_path)}")
              = link_to new_search_path, title: "Search", class: "btn" do
                %i.bi.bi-search
            %div
              = link_to "/sidekiq", title: "Sidekiq", class: "btn", target: "_blank" do
                = image_tag "sidekiq.svg", width: 22
            .ps-3.pe-3 &nbsp;
            %div
              = button_to destroy_user_session_path, method: :delete, title: "Log out", class: "btn" do
                %i.bi.bi-lock
        - else
          %div(class="#{'current-page' if current_page?(new_user_session_path)}")
            = link_to new_user_session_path, title: "Log in", class: "btn" do
              %i.bi.bi-unlock
      .content(style="width: 100%")
        .p-4
          =yield

    = render partial: "/layouts/flash_messages"

    